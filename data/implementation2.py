import numpy as np

def fidelity_with_pure_state(rho, psi):
    """
    Compute fidelity F(ρ, |ψ⟩) = ⟨ψ|ρ|ψ⟩ for a pure reference state.

    Parameters:
    rho : np.ndarray
        Density matrix (NxN)
    psi : np.ndarray
        Pure state vector (N,)

    Returns:
    float
        Fidelity value (real scalar)
    """
    psi = psi.reshape(-1, 1)  # Ensure column vector
    return np.real((psi.conj().T @ rho @ psi).item())

# Your 10x10 density matrix
rho = np.array([
    [1.02321635e-01+0.j, -1.64763604e-03+0.00100689j,  4.38720905e-04-0.00057775j,  7.62984396e-04-0.00169119j, -2.57595149e-03-0.00075503j, -3.15172875e-03+0.00318009j,  6.71256060e-04+0.00347947j,  2.94358249e-03+0.00244866j, -1.76683949e-03+0.00084451j,  9.55536162e-04+0.00112244j],
    [-1.64763604e-03-0.00100689j,  1.01009232e-01+0.j,  3.06732163e-03-0.000573j, -2.85374248e-04-0.00043835j,  1.23106210e-03+0.00018936j, -4.06120657e-04-0.00130825j, -1.75750484e-04+0.00120411j, -2.61364267e-03-0.00149586j,  2.99350329e-04-0.00143261j, -2.80395983e-03+0.0006112j],
    [4.38720905e-04+0.00057775j,  3.06732163e-03+0.000573j,  1.01502207e-01+0.j,  1.80816345e-03-0.00110502j, -6.16984828e-04+0.00347646j, -1.20923462e-03+0.00070361j, -6.15141672e-04-0.0025906j, -5.11019761e-03+0.00153229j, -5.76752744e-04+0.00114938j,  1.12418911e-03+0.00146485j],
    [7.62984396e-04+0.00169119j, -2.85374248e-04+0.00043835j,  1.80816345e-03+0.00110502j,  9.95597817e-02+0.j,  8.31972591e-04-0.00474926j, -1.28030755e-03+0.00192127j,  7.44589743e-04-0.00047261j,  4.25187606e-03-0.00172261j,  3.01584501e-04-0.00031838j,  1.18029654e-03+0.00148522j],
    [-2.57595149e-03+0.00075503j,  1.23106210e-03-0.00018936j, -6.16984828e-04-0.00347646j,  8.31972591e-04+0.00474926j,  9.91589353e-02+0.j,  4.95168965e-03-0.00081406j, -2.13428275e-03+0.00052306j, -1.60535058e-03+0.00287605j,  9.20824105e-04-0.00257741j,  2.46304807e-03+0.00028184j],
    [-3.15172875e-03-0.00318009j, -4.06120657e-04+0.00130825j, -1.20923462e-03-0.00070361j, -1.28030755e-03-0.00192127j,  4.95168965e-03+0.00081406j,  1.00004153e-01+0.j, -3.95917582e-03-0.00248866j,  1.81790236e-03-0.0040135j,  1.60634215e-03-0.00016484j,  1.96549167e-03-0.00053289j],
    [6.71256060e-04-0.00347947j, -1.75750484e-04-0.00120411j, -6.15141672e-04+0.0025906j,  7.44589743e-04+0.00047261j, -2.13428275e-03-0.00052306j, -3.95917582e-03+0.00248866j,  1.00026347e-01+0.j,  4.22904184e-03-0.00322086j, -3.46180633e-03-0.00487452j,  9.33065037e-05-0.00232111j],
    [2.94358249e-03-0.00244866j, -2.61364267e-03+0.00149586j, -5.11019761e-03-0.00153229j,  4.25187606e-03+0.00172261j, -1.60535058e-03-0.00287605j,  1.81790236e-03+0.0040135j,  4.22904184e-03+0.00322086j,  1.01817985e-01+0.j, -1.13846590e-03-0.00292783j,  1.08709684e-03+0.0028279j],
    [-1.76683949e-03-0.00084451j,  2.99350329e-04+0.00143261j, -5.76752744e-04-0.00114938j,  3.01584501e-04+0.00031838j,  9.20824105e-04+0.00257741j,  1.60634215e-03+0.00016484j, -3.46180633e-03+0.00487452j, -1.13846590e-03+0.00292783j,  9.78942972e-02+0.j,  1.76033552e-03-0.00307631j],
    [9.55536162e-04-0.00112244j, -2.80395983e-03-0.0006112j,  1.12418911e-03-0.00146485j,  1.18029654e-03-0.00148522j,  2.46304807e-03-0.00028184j,  1.96549167e-03+0.00053289j,  9.33065037e-05+0.00232111j,  1.08709684e-03-0.0028279j,  1.76033552e-03+0.00307631j,  9.67051654e-02+0.j]
], dtype=complex)

# Reference state |0⟩ (vacuum)
psi_ref = np.array([1, 0, 0, 0, 0, 0, 0, 0, 0, 0], dtype=complex)

# Fidelity computation
F = fidelity_with_pure_state(rho, psi_ref)
print("Fidelity with |0⟩ state:", F)
